同一时刻在线问题
思路：可以将进入时间与离开时间放到同一维度进行思考，进入就加一，离开就减一
步骤：	1、使用union将进入时间和离开时间放到同一维度，增加标志列（进入时间为1，离开时间为-1）
	  	2、按照用户ID、日期排序（不能去重，因为同一时刻可能有进有出，也可能同时进同时出）
	  	3、使用开窗函数，按日期排序，计算从开头到当前行的标志列的和（rows between unbounded preceding and current row）


连续问题
思路一：首先对数据进行去重，因为同一天可能多次登录，然后按照登录日期进行排序，想要得到连续几天就使用lead函数向后几行取排序后的日期，然后使用当前日期与取得的日期求差值（datediff），差值等于N则连续登录N天
步骤：	1、从数据中抽取用户id及登录日期，并去重
		2、按用户id进行分组，使用lead函数取后N行的日期
		3、使用当前日期与取得的日期求差值，差值等于N则登录N天，否则不连续或连续不足N天
思路二：首先对数据去重，并按日期进行排序，使用当前日期减去排序后的序号得到新的日期，新的日期相同的数据则连续
步骤：	1、从数据中抽取用户id及登录日期，并去重
		2、按照用户id进行分组，使用row_number()对登录日期进行排序
		3、使用当前日期减去排序后的序号（date_sub函数），得到一个日期，用户id与这个日期相同的数据则可认为这些数据连续